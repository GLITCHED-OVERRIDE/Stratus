<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Roulette Hero</title>

  <link rel="shortcut icon" href="TemplateData/favicon.ico">

  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
    }

    #unity-container {
      width: 100%;
      height: 100%;
      position: fixed;
      inset: 0;
    }

    #unity-canvas {
      width: 100%;
      height: 100%;
      display: block;
      outline: none;
    }

    #unity-loading-bar,
    #unity-warning,
    #unity-footer {
      display: none !important;
    }
  </style>
</head>

<body>
  <div id="unity-container">
    <canvas id="unity-canvas" tabindex="-1"></canvas>
  </div>

  <script>
    const canvas = document.getElementById("unity-canvas");

    function unityShowBanner() {}

    const buildUrl = "Build";
    const loaderUrl = buildUrl + "/Web.loader.js";

    // Utility: merge multiple .part files into a single Blob
    async function fetchAndMergeParts(baseName, partCount) {
      const urls = Array.from({length: partCount}, (_, i) => `${buildUrl}/${baseName}.part${i+1}`);
      const buffers = await Promise.all(urls.map(url => fetch(url).then(r => r.arrayBuffer())));
      const merged = new Uint8Array(buffers.reduce((sum, b) => sum + b.byteLength, 0));
      let offset = 0;
      buffers.forEach(b => {
        merged.set(new Uint8Array(b), offset);
        offset += b.byteLength;
      });
      return new Blob([merged]);
    }

    (async () => {
      // Merge data and wasm parts
      const [dataBlob, wasmBlob] = await Promise.all([
        fetchAndMergeParts("Web.data.br", 5),
        fetchAndMergeParts("Web.wasm.br", 3)
      ]);

      const config = {
        dataUrl: URL.createObjectURL(dataBlob),
        frameworkUrl: buildUrl + "/Web.framework.js.br",
        codeUrl: URL.createObjectURL(wasmBlob),
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Free Lives",
        productName: "Roulette Hero",
        productVersion: "0.1",
        showBanner: unityShowBanner,
      };

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      const script = document.createElement("script");
      script.src = loaderUrl;
      script.onload = () => {
        createUnityInstance(canvas, config, () => {})
          .catch(() => {});
      };
      document.body.appendChild(script);
    })();
  </script>
</body>
</html>
